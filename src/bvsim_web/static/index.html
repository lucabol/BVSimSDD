<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>BVSim Web</title>
<style>
body { font-family: system-ui, sans-serif; margin: 0; padding: 0; }
header { background:#0d47a1; color:#fff; padding:12px 20px; }
main { padding:16px; display:flex; flex-wrap:wrap; gap:24px; }
section { flex:1 1 400px; min-width:360px; background:#f5f7fa; padding:12px 16px; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,.1); }
h2 { margin-top:0; font-size:1.1rem; }
label { display:block; margin-top:6px; font-size:.85rem; font-weight:600; }
input, select, button, textarea { width:100%; margin-top:2px; padding:6px 8px; font-size:.9rem; }
button { cursor:pointer; background:#1976d2; color:#fff; border:none; border-radius:4px; margin-top:8px; }
button.secondary { background:#546e7a; }
#output { white-space:pre-wrap; font-family:monospace; background:#111; color:#eee; padding:12px; border-radius:8px; max-height:400px; overflow:auto; }
#output.collapsed { display:none; }
canvas#skillsChart { width:100%; }
ul.team-list { list-style:none; padding:0; margin:0; }
ul.team-list li { padding:4px 0; display:flex; justify-content:space-between; font-size:.85rem; border-bottom:1px solid #ddd; }
small { color:#555; }
.flex { display:flex; gap:8px; }
.flex > div { flex:1; }
.badge { background:#1976d2; color:#fff; padding:2px 6px; border-radius:4px; font-size:.7rem; }
footer { margin-top:24px; padding:12px 20px; font-size:.75rem; color:#555; }
table.match-impact { width:100%; border-collapse:collapse; margin-top:8px; font-size:.7rem; }
table.match-impact thead { background:#0d47a1; color:#fff; }
table.match-impact th, table.match-impact td { padding:4px 6px; text-align:left; border:1px solid #ccc; }
table.match-impact tbody tr:nth-child(even) { background:#eef4f9; }
table.match-impact tbody tr:hover { background:#e1edf7; }
table.match-impact .sig-pos { color:#0d652d; font-weight:600; }
table.match-impact .sig-neg { color:#b71c1c; font-weight:600; }
table.match-impact caption { caption-side:bottom; padding:4px; font-size:.65rem; color:#555; }
.status { font-size:.65rem; color:#555; margin-top:4px; min-height:14px; }
.status .spinner { display:inline-block; width:10px; height:10px; border:2px solid #1976d2; border-top-color:transparent; border-radius:50%; animation:spin 0.7s linear infinite; margin-right:4px; }
@keyframes spin { to { transform:rotate(360deg); } }
</style>
</head>
<body>
<header>
  <h1>BVSim Web Interface</h1>
</header>
<main>
  <section id="teams">
    <h2>Teams</h2>
    <div class="flex">
      <div>
        <label>Create Team</label>
        <input id="newTeamName" placeholder="Name" />
        <select id="newTeamTemplate">
          <option value="basic">Basic Template</option>
          <option value="advanced">Advanced Template</option>
        </select>
        <button onclick="createTeam()">Create</button>
      </div>
      <div>
        <label>Upload Team YAML</label>
        <input type="file" id="uploadTeamFile" accept=".yaml,.yml" />
        <button onclick="uploadTeam()">Upload</button>
      </div>
    </div>
    <h3>Available Teams</h3>
    <ul class="team-list" id="teamList"></ul>
    <button class="secondary" onclick="refreshTeams()">Refresh</button>
  </section>

  <section id="simulate">
    <h2>Simulate</h2>
    <label>Team A</label>
    <input id="simTeamA" placeholder="team_a.yaml or name" />
    <label>Team B</label>
    <input id="simTeamB" placeholder="team_b.yaml or name" />
    <label>Points (blank=default)</label>
    <input id="simPoints" type="number" />
    <div class="flex">
      <button onclick="simulate()">Run Simulation</button>
      <button onclick="simulateQuick()" class="secondary">Quick</button>
      <button onclick="simulateAccurate()" class="secondary">Accurate</button>
    </div>
  </section>

  <section id="skills">
    <h2>Skills Analysis</h2>
    <label>Team</label>
    <input id="skillsTeam" placeholder="team_a.yaml or name" />
    <label>Opponent (optional)</label>
    <input id="skillsOpponent" placeholder="team_b.yaml or name" />
    <label>Improve (e.g. 5% or 0.05)</label>
    <input id="skillsImprove" placeholder="5%" />
    <div class="flex">
      <button onclick="skillsAnalysis()">Analyze</button>
      <button onclick="skillsQuick()" class="secondary">Quick</button>
      <button onclick="skillsAccurate()" class="secondary">Accurate</button>
    </div>
  <div id="skillsStatus" class="status"></div>
  </section>

  <section id="compare">
    <h2>Compare Teams</h2>
    <label>Teams (comma separated)</label>
    <input id="compareTeams" placeholder="team_a.yaml,team_b.yaml" />
    <div class="flex">
      <button onclick="compareTeamsRun()">Compare</button>
      <button onclick="compareQuick()" class="secondary">Quick</button>
      <button onclick="compareAccurate()" class="secondary">Accurate</button>
    </div>
  </section>

  <section id="examplesSection">
    <h2>Rally Examples</h2>
    <label>Team A</label><input id="exTeamA" />
    <label>Team B</label><input id="exTeamB" />
    <label>Count</label><input id="exCount" type="number" value="5" />
  <button onclick="runExamples()">Generate</button>
  </section>

  <!-- Visualization section removed as per requirement -->
  <section style="flex:1 1 100%" id="confidenceChartSection">
  <h2>Match Impact Confidence Chart</h2>
  <p style="font-size:.75rem;color:#555;margin-top:-6px">This pane now visualizes: (a) Skills Analysis parameter impact (CI scatter), (b) Simulation win rates (bar), and (c) Team Comparison rankings & matrix (bar + table).</p>
    <canvas id="matchImpactChart" height="250" style="max-height:600px;width:100%;"></canvas>
  <div id="matchImpactLegend" style="display:flex;flex-wrap:wrap;margin-top:4px"></div>
  <div id="matchImpactTableContainer"></div>
  <div id="matchImpactStatus" class="status"></div>
  </section>

  <section style="flex:1 1 100%">
    <h2 style="display:flex;align-items:center;justify-content:space-between;cursor:pointer" onclick="toggleOutput()">Output <span id="outputToggle" style="font-size:.7rem;background:#1976d2;color:#fff;padding:2px 6px;border-radius:4px;">Show</span></h2>
    <div id="output" class="collapsed" style="display:none"></div>
  </section>
</main>
<footer>
  BVSim Web MVP - Generated interface. Edit YAML files directly to fine-tune probabilities.
</footer>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="/static/app.js"></script>
</body>
</html>
